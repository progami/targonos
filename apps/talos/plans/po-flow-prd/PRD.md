# Talos Purchase Orders — Stage PRD + UI Sketches

## Scope

- Region: Tactical (US + UK)
- Stages: **RFQ → Issued → Manufacturing → In Transit → At Warehouse**
- Non-stage outcomes:
  - Outbound shipping happens via **Fulfillment Orders** (not a PO stage)
  - Rejected/Canceled are exception states (read-only or reopen)

## Global Rules (apply everywhere)

- **One page layout across the whole flow**
  - Creating a new RFQ uses the same screen as viewing an existing RFQ/PO; only editability changes.
  - Tabs remain: **Details / Cargo / Costs / Documents / History**
- **Stage-scoped tabs**
  - Clicking a stage in the timeline scopes the tabs to that stage’s fields/docs/costs.
  - Past stages are viewable (read-only); the current stage is editable.
- **No gating modals**
  - If something required is missing, the transition fails and the UI highlights:
    - the tab (red `!`)
    - the exact field/row (red `!`)
  - The UI navigates to the first failing tab and scrolls to the first failing field.
- **Required indicators are contextual**
  - Red `!` is only used for:
    - the current stage’s primary action (Issue / Advance / Receive), and
    - outputs that the user can generate right now (e.g. Shipping Marks download).
  - Past stages do not show new “required” indicators for transitions that already succeeded.
- **Cargo has no money**
  - Cargo tab is physical reality (units/cartons/pallets/dims/weights/PI refs).
  - Costs tab is money (targeted/confirmed costs, freight, inbound, etc).
- **Supplier banking lives on the Supplier**
  - PO issuance/PDF generation requires supplier banking info to exist on the Supplier record.
- **Ship-to is standardized**
  - Ship-to uses our company legal entity (name/address).
  - Phone + country code are hardcoded (we know our company).
  - The legal entity (US vs UK) is derived from the current Talos **Region** (US or UK).
  - Tactical assumption: Warehouse selection does not change the ship-to address shown on RFQ/PO outputs.

## Required Inputs (shared across the flow)

- Region is determined by the current Talos Region (US or UK)
- Supplier selection (required to Issue)
- Cargo lines (SKU + batch + quantities + packaging)
- **PI**
  - PI number on every cargo line (required to Issue)
  - PI document upload(s) for each PI number used across cargo lines (required to Issue)
- Targeted product costs (entered in RFQ; become confirmed at Issued)
- Shipping mark inputs (per cargo line; required to Issue + generate Shipping Marks)
  - Commodity code (region-specific)
  - Country of origin
  - Units/carton (cartons derived; must divide units ordered)
  - Carton size (cm)
  - Net weight (kg)
  - Gross weight (kg)
  - Material

Commodity code can optionally show a lookup description to help users verify they entered the correct code.

## Outputs (generated by Talos)

- RFQ PDF (RFQ stage)
- PO PDF (Issued stage)
- **Shipping Marks (carton marks)** (Issued stage)

Outputs are generated on download and show “generated by” + timestamp. If inputs change after generation, the UI shows an “out of date” indicator.

---

## Stage 1 — RFQ

### Goal

Create a complete RFQ that can be issued into a PO with no ambiguity.

### Requirements to move to **Issued** (blocking)

- Supplier selected
- Terms filled: cargo-ready date, incoterms, payment terms
- At least one cargo line
- For every cargo line:
  - SKU + batch
  - units ordered + units/carton (cartons derived; must divide)
  - PI number
  - Shipping Marks inputs (commodity code, country of origin, carton size, net + gross weight, material)
  - targeted product cost
- PI documents uploaded:
  - one PI document for each PI number used across cargo lines
- Supplier has banking info configured (in Suppliers)

If issuance fails because supplier banking is missing, the UI highlights the Supplier field and provides a direct link to open the Supplier record.

### RFQ UI sketches (per tab)

#### RFQ → Details tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Purchase Orders / RFQ                                                        │
│ Stage:  [RFQ*]──[Issued]──[Manufacturing]──[In Transit]──[At Warehouse]      │
│ Actions: [Issue PO] [Download RFQ PDF]                                       │
├───────────────────────────────────────────────────────────────────────────────┤
│ Tabs:  [Details* !] [Cargo !] [Costs !] [Documents !] [History]              │
├───────────────────────────────────────────────────────────────────────────────┤
│ Region:           US (or UK)                                                   │
│ Supplier:        [ Select Supplier ]  !                                      │
│ Ship To (derived): Targon (US/UK entity derived from Region)                 │
│                 (address)  |  (country code)  |  (phone)                     │
│ Cargo Ready Date: [   yyyy-mm-dd   ]  !                                      │
│ Incoterms:       [   Select...    ]  !                                      │
│ Payment Terms:   [   Text...      ]  !                                      │
│ Notes:           [ ...optional... ]                                          │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### RFQ → Cargo tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo* !] [Costs !] [Documents !] [History]                │
├───────────────────────────────────────────────────────────────────────────────┤
│ Cargo Lines (editable)                                                        │
│ ┌───────┬─────────┬──────────┬──────────┬─────────┬───────────────┬───────┐ │
│ │ SKU   │ Batch   │ Units    │ Units/ctn│ Cartons │ PI Number      │  !    │ │
│ ├───────┼─────────┼──────────┼──────────┼─────────┼───────────────┼───────┤ │
│ │ CS007 │ B03     │ 34,410   │ 62       │ 555     │ [ PI-2601082 ] │      │ │
│ │ ...   │ ...     │ ...      │ ...      │ ...     │ [     ...    ] │  !   │ │
│ └───────┴─────────┴──────────┴──────────┴─────────┴───────────────┴───────┘ │
│ Sub-tabs: [Line Details*] [Packaging / Attributes]                             │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### RFQ → Cargo tab → Packaging / Attributes
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo* !] [Costs !] [Documents !] [History]                │
├───────────────────────────────────────────────────────────────────────────────┤
│ Sub-tabs: [Line Details] [Packaging / Attributes*]                             │
├───────────────────────────────────────────────────────────────────────────────┤
│ Shipping Mark Inputs (per cargo line)                                          │
│ - Commodity Code:     [ ________ ]   !   (US/UK differs; format checked)       │
│ - Country of Origin:  [ ________ ]   !   (e.g. “Made in China”)                │
│                                                                               │
│ Carton / Weight Inputs                                                         │
│ - Units per carton:   [   62   ]   !                                          │
│ - Carton size (cm):   [ 28 ] × [ 43.5 ] × [ 57 ]   !                           │
│ - Net weight (kg):    [ 20.8 ]   !                                             │
│ - Gross weight (kg):  [ 21.8 ]   !                                             │
│ - Material:           [ ________ ]   !                                         │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### RFQ → Costs tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs* !] [Documents !] [History]                  │
├───────────────────────────────────────────────────────────────────────────────┤
│ Targeted Product Costs (editable)                                              │
│ ┌───────┬─────────┬──────────┬───────────┬──────────────┬───────────────┐   │
│ │ SKU   │ Batch   │ Units    │ Currency  │ Target Unit  │ Target Total   │   │
│ ├───────┼─────────┼──────────┼───────────┼──────────────┼───────────────┤   │
│ │ CS007 │ B03     │ 34,410   │ USD       │ [ 0.0091 ]   │ [ 313.13 ]  !  │   │
│ └───────┴─────────┴──────────┴───────────┴──────────────┴───────────────┘   │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### RFQ → Documents tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents* !] [History]                    │
├───────────────────────────────────────────────────────────────────────────────┤
│ Required Uploads (RFQ → Issued)                                                │
│ - Proforma Invoice (PI) documents                                              │
│   • PI-2601082  [Upload/Replace]  !                                            │
│   • PI-2601083  [Upload/Replace]                                               │
│                                                                               │
│ Outputs                                                                        │
│ - RFQ PDF [Download]                                                           │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### RFQ → History tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents] [History*]                       │
├───────────────────────────────────────────────────────────────────────────────┤
│ Audit Log                                                                       │
│ - RFQ created                                                                    │
│ - Supplier updated                                                                │
│ - Cargo line added/edited                                                         │
│ - PI uploaded                                                                     │
│ - Targeted costs edited                                                           │
└───────────────────────────────────────────────────────────────────────────────┘
```

---

## Stage 2 — Issued (PO)

### Goal

Turn the RFQ into a PO (single source of truth) and generate all PO outputs before production starts.

### Requirements to move to **Manufacturing** (blocking)

- Shipping Marks inputs complete for all cargo lines:
  - commodity code (region-specific)
  - country of origin
  - carton size, units/carton, net + gross weight, material
- Units ordered must be divisible by units/carton (so carton count and marks are unambiguous)
  - If not divisible, cartons are shown as `—` and the UI highlights the units + units/carton fields.

At Issued, commercial fields are locked (terms, ordered units, PI numbers, confirmed product costs). Packaging + Shipping Marks inputs remain editable until advancing to Manufacturing.

### Issued UI sketches (per tab)

#### Issued → Details tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Purchase Orders / PO                                                            │
│ Stage:  [RFQ]──[Issued*]──[Manufacturing]──[In Transit]──[At Warehouse]       │
│ Actions: [Advance → Manufacturing]                                             │
├───────────────────────────────────────────────────────────────────────────────┤
│ Tabs:  [Details*] [Cargo] [Costs] [Documents] [History]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ PO Number: PO-XXXX                                                              │
│ Supplier: <Selected Supplier>  (banking info must exist in Suppliers)          │
│ Ship To:  Targon LLC, 1960 Kimball Ave, Suite 316, Manhattan, KS               │
│          US  |  +1 785-370-3532                                                │
│ Terms: Cargo Ready Date / Incoterms / Payment Terms (read-only snapshot)       │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Issued → Cargo tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo*] [Costs] [Documents] [History]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ Cargo Lines (commercial snapshot)                                               │
│ - SKU / Batch / Units / Units per carton / Cartons                              │
│ - PI number per line (read-only)                                                │
│ Sub-tabs: [Line Details*] [Packaging / Shipping Marks !]                        │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Issued → Cargo tab → Packaging / Shipping Marks
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo*] [Costs] [Documents] [History]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ Sub-tabs: [Line Details] [Packaging / Shipping Marks* !]                       │
├───────────────────────────────────────────────────────────────────────────────┤
│ Shipping Mark Inputs (editable at Issued)                                      │
│ - Commodity Code:     [ ________ ]  !   (region-specific; format checked)      │
│ - Country of Origin:  [ ________ ]  !                                          │
│ - Units per carton:   [   62   ]   !                                          │
│ - Carton size (cm):   [ 28 ] × [ 43.5 ] × [ 57 ]  !                            │
│ - Net weight (kg):    [ 20.8 ]   !                                            │
│ - Gross weight (kg):  [ 21.8 ]   !                                            │
│ - Material:           [ ________ ]  !                                          │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Issued → Costs tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs*] [Documents] [History]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ Confirmed Product Costs (read-only)                                             │
│ (these come from RFQ targeted costs and are now treated as confirmed)          │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Issued → Documents tab (includes Shipping Marks)
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents*] [History]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ Outputs                                                                         │
│ - PO PDF            [Download]        (requires supplier banking info)         │
│ - Shipping Marks    [Download]        (carton marks, includes PI + carton info)│
│                                                                               │
│ Reference Documents (read-only)                                                 │
│ - PI documents list (from RFQ)                                                  │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Issued → History tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents] [History*]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ - RFQ → Issued (who/when)                                                      │
│ - PO PDF generated/downloaded                                                  │
│ - Shipping marks generated/downloaded                                          │
└───────────────────────────────────────────────────────────────────────────────┘
```

### Shipping Marks (Issued output)

Shipping marks are a print-ready download with one label per carton:

- `Carton 1 / 555`, `Carton 2 / 555`, …

Assumption (Tactical): cartons are homogeneous per cargo line (single SKU + batch). Mixed-carton packing is not supported.

**Each mark contains**

- PI number
- SKU + batch (shipping mark)
- Carton dimensions (cm)
- Units per carton
- Carton numbering (`Carton X / Total Cartons`)
- Material
- Commodity code
- Net weight
- Gross weight
- Country of origin (e.g. “Made in China”)

**Blocking rules**

- If any required shipping-mark data is missing, generation fails with no modal and highlights the exact missing inputs (e.g., packaging dimensions/weights, commodity code).

---

## Stage 3 — Manufacturing

### Goal

Track production start and ensure manufacturing artifacts (box artwork) are complete.

### Requirements to move to **In Transit** (blocking)

- Manufacturing start date filled
- Box artwork uploaded
- Split allocation confirmed:
  - per cargo line: cartons shipping now (this PO)
  - remaining cartons are either moved into a new Remainder PO (ships later) or explicitly cancelled (final variance)

### Manufacturing UI sketches (per tab)

#### Manufacturing → Details tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Stage:  [RFQ]──[Issued]──[Manufacturing*]──[In Transit]──[At Warehouse]       │
│ Actions: [Dispatch → In Transit]                                                │
├───────────────────────────────────────────────────────────────────────────────┤
│ Split: [ Create Remainder PO (if needed) ▾ ]                                    │
│ Tabs:  [Details* !] [Cargo !] [Costs] [Documents !] [History]                  │
├───────────────────────────────────────────────────────────────────────────────┤
│ Manufacturing Start Date: [ yyyy-mm-dd ]  !                                    │
│ Factory Name:             [ text... ]                                          │
│ Packaging Notes:          [ ... ]                                              │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Manufacturing → Cargo tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo* !] [Costs] [Documents !] [History]                    │
├───────────────────────────────────────────────────────────────────────────────┤
│ Split: [ Create Remainder PO (if needed) ▾ ]                                    │
│ Split Allocation (no modal)                                                     │
│ - Confirm which cartons ship now vs later (or cancel remainder as final)        │
│ ┌───────┬─────────┬──────────────┬───────────────┬──────────────┬───────────┐ │
│ │ SKU   │ Batch   │ Total Cartons│ Ship Now Cartons│ Remaining    │ Cancel?   │ │
│ ├───────┼─────────┼──────────────┼───────────────┼──────────────┼───────────┤ │
│ │ CS007 │ B03     │ 555          │ [ 300 ]        │ 255          │ [  ]      │ │
│ │ ...   │ ...     │ ...          │ [ ... ]        │ ...          │ [  ]      │ │
│ └───────┴─────────┴──────────────┴───────────────┴──────────────┴───────────┘ │
│ Notes: if Remaining is cancelled, require reason + create credit/debit when final │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Manufacturing → Costs tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs*] [Documents !] [History]                      │
├───────────────────────────────────────────────────────────────────────────────┤
│ Confirmed Product Costs (read-only)                                             │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Manufacturing → Documents tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents* !] [History]                      │
├───────────────────────────────────────────────────────────────────────────────┤
│ Required Uploads                                                                │
│ - Box Artwork  [Upload/Replace]  !                                              │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### Manufacturing → History tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents] [History*]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ - Issued → Manufacturing (who/when)                                            │
│ - Manufacturing dates updated                                                  │
│ - Box artwork uploaded                                                         │
└───────────────────────────────────────────────────────────────────────────────┘
```

---

## Stage 4 — In Transit (Ocean)

### Goal

Record shipment identifiers + documents and record freight (required for receiving allocation).

### Split shipments & quantity variance (Tactical)

This workflow must support **real-world divergence** after a PO is issued (and potentially paid) but before all goods are shipped.

**Chosen approach (Tactical): split into separate POs (one shipment per PO)**

- When the factory cannot load everything, we split the PO into:
  - the **Shipping PO** (what ships now), and
  - a new **Remainder PO** (what ships later)
- Both POs are linked and show sibling navigation (Split Group).
- Each split PO flows independently through **In Transit → At Warehouse → Receive** with its own docs and freight.

**Key principles**

- **Commercial quantities** must not be silently overwritten after issuance:
  - post-issuance changes only happen via explicit actions (split/cancel) with a history record
- **Physical quantities** (what is produced / loaded / shipped / received) can diverge and must be explicitly confirmed at the points where reality changes.
- **Shipping Marks are locked** once the PO enters Manufacturing (they are a prerequisite for Manufacturing).
- **Freight / forwarding costs are split-PO-scoped** (each split PO represents one shipment).
- If a PO is **paid in full** but ships short / ships extra, the system must handle the financial reconciliation via **credit/debit notes** (tracked as financial entries, not by mutating history).

**When manufacturing finishes but the factory cannot load everything**

- At **Manufacturing → Dispatch → In Transit**, the user confirms how many cartons ship now per cargo line.
- Talos then:
  - advances the current PO to **In Transit** using the “ship now” cartons, and
  - creates a new **Remainder PO** in **Manufacturing** for the remaining cartons (ready to dispatch later)
- Shipping Marks **do not change**:
  - Talos assigns a **carton range per cargo line** to each split PO (e.g., cartons 1–300 of 555 for PO-A, cartons 301–555 of 555 for PO-B)
  - each split PO can download Shipping Marks filtered to its carton ranges
  - the label format stays `Carton X / OriginalTotalCartons` so carton prints remain consistent

**If supplier produces less or more than ordered**

- Split POs do **not** create credit/debit notes by default.
- Credit/debit notes are only created when the variance is explicitly treated as **final**, e.g.:
  - the remainder PO is cancelled as “not producing / cancelled”, or
  - a split PO is received short/over and the split group is closed with a confirmed variance.
- System calculates the default credit/debit amount; user can override with a reason + supporting document.

**Accounting safeguards**

- Splitting moves quantities (and therefore product cost totals) between POs; it must not duplicate them.
- Freight/forwarding is recorded per split PO (per shipment).
- Inbound/outbound/storage costs attach to real ledger events (ship/receive), referencing the correct split PO.
- If a future enhancement allows one shipment/container to include multiple POs, freight must be **allocated**, not duplicated (out of scope for Tactical MVP unless explicitly required).

### Requirements to move to **At Warehouse** (blocking)

- Transit identifiers filled:
  - bill of lading reference
  - commercial invoice number
  - packing list reference
  - vessel name
  - port of loading + port of discharge
- Transit documents uploaded:
  - commercial invoice
  - bill of lading
  - packing list
- Freight cost recorded (single total)

### In Transit UI sketches (per tab)

#### In Transit → Details tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Stage:  [RFQ]──[Issued]──[Manufacturing]──[In Transit*]──[At Warehouse]       │
│ Actions: [Advance → At Warehouse]                                              │
├───────────────────────────────────────────────────────────────────────────────┤
│ Tabs:  [Details* !] [Cargo] [Costs !] [Documents !] [History]                 │
├───────────────────────────────────────────────────────────────────────────────┤
│ Vessel Name:              [ text... ]  !                                       │
│ Port of Loading:          [ text... ]  !                                       │
│ Port of Discharge:        [ text... ]  !                                       │
│ Bill of Lading Ref:       [ text... ]  !                                       │
│ Commercial Invoice #:     [ text... ]  !                                       │
│ Packing List Ref:         [ text... ]  !                                       │
│ ETD / ETA:                [ dates... ]                                         │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### In Transit → Cargo tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo*] [Costs !] [Documents !] [History]                   │
├───────────────────────────────────────────────────────────────────────────────┤
│ Cargo Summary (read-only)                                                       │
│ - Lines, cartons, pallets, CBM, KG                                              │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### In Transit → Costs tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs* !] [Documents !] [History]                   │
├───────────────────────────────────────────────────────────────────────────────┤
│ Freight (required)                                                              │
│ Total Freight: [  ________ ]  Currency: [ USD ]  Notes: [ ... ]  !             │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### In Transit → Documents tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents* !] [History]                      │
├───────────────────────────────────────────────────────────────────────────────┤
│ Required Uploads                                                                │
│ - Commercial Invoice  [Upload/Replace]  !                                       │
│ - Bill of Lading      [Upload/Replace]  !                                       │
│ - Packing List        [Upload/Replace]  !                                       │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### In Transit → History tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents] [History*]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ - Manufacturing → In Transit (who/when)                                        │
│ - Transit identifiers updated                                                   │
│ - Freight recorded/updated                                                      │
│ - Transit docs uploaded                                                         │
└───────────────────────────────────────────────────────────────────────────────┘
```

---

## Stage 5 — At Warehouse

### Goal

Receive inventory (inventory ledger source of truth) and record customs + inbound artifacts needed for reconciliation.

After inventory is received, the PO becomes **Received/Closed** and is read-only.
Tactical receiving is a single receive event:
- Received quantity can differ from ordered quantity, but discrepancy notes are required for any mismatch.

### Requirements to **Receive** (blocking)

- Warehouse selected + receive type selected
- Import entry number provided (format checked; varies by region)
- Customs cleared date set
- Received date set
- Freight recorded
- Required documents uploaded:
  - movement note
  - Customs & Border Patrol Clearance Proof (CDS for UK)

### At Warehouse UI sketches (per tab)

#### At Warehouse → Details tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Stage:  [RFQ]──[Issued]──[Manufacturing]──[In Transit]──[At Warehouse*]       │
│ Actions: [Receive Inventory]                                                   │
├───────────────────────────────────────────────────────────────────────────────┤
│ Tabs:  [Details* !] [Cargo] [Costs] [Documents !] [History]                   │
├───────────────────────────────────────────────────────────────────────────────┤
│ Warehouse:            [ Select warehouse ]  !                                  │
│ Receive Type:         [ Select... ]        !                                   │
│ Import Entry Number:  [  format-checked   ] !                                  │
│ Customs Cleared Date: [ yyyy-mm-dd ]       !                                   │
│ Received Date:        [ yyyy-mm-dd ]       !                                   │
│ Duty (optional):      [ amount ] [ currency ]                                  │
│ Discrepancy Notes:    [ ... ]                                                  │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### At Warehouse → Cargo tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo*] [Costs] [Documents !] [History]                      │
├───────────────────────────────────────────────────────────────────────────────┤
│ Receiving Summary                                                               │
│ - Ordered vs Received per line                                                  │
│ - Receiving editor (defaults received = ordered)                                │
│ - If mismatch, require discrepancy notes                                        │
│ - Links to inventory ledger entries created from receiving                       │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### At Warehouse → Cargo tab → Receiving editor
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Cargo Lines (receiving)                                                        │
│ ┌───────┬─────────┬──────────┬───────────┬───────────────────────────────┐   │
│ │ SKU   │ Batch   │ Ordered  │ Received  │ Discrepancy Notes             │   │
│ ├───────┼─────────┼──────────┼───────────┼───────────────────────────────┤   │
│ │ CS007 │ B03     │ 34,410   │ [34,410]  │ [ ... required if mismatch ]  │   │
│ │ ...   │ ...     │ ...      │ [ ... ]   │ [ ... ]                        │   │
│ └───────┴─────────┴──────────┴───────────┴───────────────────────────────┘   │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### At Warehouse → Costs tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs*] [Documents !] [History]                      │
├───────────────────────────────────────────────────────────────────────────────┤
│ - Product costs (read-only)                                                     │
│ - Freight (read-only; used for allocation)                                      │
│ - Inbound costs (calculated from rates; read-only)                              │
│ - Storage accrual (read-only)                                                   │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### At Warehouse → Documents tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents* !] [History]                      │
├───────────────────────────────────────────────────────────────────────────────┤
│ Required Uploads                                                                │
│ - Movement Note            [Upload/Replace]  !                                  │
│ - Customs & Border Patrol Clearance Proof (CDS for UK)                           │
│   [Upload/Replace]  !                                                           │
└───────────────────────────────────────────────────────────────────────────────┘
```

#### At Warehouse → History tab
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs:  [Details] [Cargo] [Costs] [Documents] [History*]                        │
├───────────────────────────────────────────────────────────────────────────────┤
│ - In Transit → At Warehouse (who/when)                                         │
│ - Inventory received                                                           │
│ - Warehouse docs uploaded                                                      │
│ - Inbound cost calculated                                                      │
└───────────────────────────────────────────────────────────────────────────────┘
```

---

## Data Needed for Shipping Marks (validation list)

Shipping marks generation depends on the system having:

- PI number per cargo line (already required)
- Carton size
- Units per carton
- Net weight and gross weight inputs
- Material
- Commodity code (user input; differs by region)
- Country of origin (user input)

If any of these are missing, Shipping Marks generation is blocked and the missing fields are highlighted.

'use strict';(function(k){var m=window.AmazonUIPageJS||window.P,r=m._namespace||m.attributeErrors,b=r?r("DetailPageUnifiedTradeInIngressAssets",""):m;b.guardFatal?b.guardFatal(k)(b,window):b.execute(function(){k(b,window)})})(function(k,m,r){k.when("A","cc-manager","unified-trade-in-cc-constants").register("unified-trade-in-add-to-cart-actions",(b,a,d)=>({addAdditionalParamToATC:function(b){b&&(b={selectionType:"add",enableIA:!1,formData:[{inputType:"hidden",inputName:"tradeInIntentId",inputValue:b}]},
a.ccSelectionsClear(d.featureName),a.ccSelectionUpdate(d.featureName,b))}}));"use strict";k.when("A","a-button","unified-trade-in-cc-constants","unified-trade-in-metric-emitter").register("unified-trade-in-button-factory",(b,a,d,f)=>{function k(a){return a.hasClass(d.uiElements.buttonFactory.actionButtonClass)&&0<a.find(d.uiElements.buttonFactory.displayTextSelector).length&&0<a.find(d.uiElements.buttonFactory.loadingSpinnerSelector).length}return{getInstance:function(h,n){if(!k(h)||!n)return f.count("UnifiedTradeIn.Error.ButtonFactory.GetInstance.InvalidButton"),
null;const p=d.uiElements.buttonFactory.classPrefix+n;h.addClass(p);const g=a("."+p);let t,e;return{isBlocked(){return!g.isEnabled()},block(){this.isBlocked()?f.count("UnifiedTradeIn.Error.ButtonController.Block.AlreadyBlocked"):(g.disable(),t=b.delay(()=>{h.find(d.uiElements.buttonFactory.displayTextSelector).addClass(d.uiElements.styles.invisibleClass);h.find(d.uiElements.buttonFactory.loadingSpinnerSelector).removeClass(d.uiElements.styles.invisibleClass)},d.uiElements.buttonFactory.spinnerDelayMs),
e=b.delay(()=>{this.reset()},d.remoteOperations.timeoutMs))},reset(){clearTimeout(t);clearTimeout(e);h.find(d.uiElements.buttonFactory.loadingSpinnerSelector).addClass(d.uiElements.styles.invisibleClass);h.find(d.uiElements.buttonFactory.displayTextSelector).removeClass(d.uiElements.styles.invisibleClass);g.enable()},destroy(){this.reset();h.removeClass(p)}}}}});"use strict";k.when("A","unified-trade-in-cc-constants","unified-trade-in-add-to-cart-actions","cc-manager","unified-trade-in-quantity-handler",
"unified-trade-in-metric-emitter","unified-trade-in-state-freshness-handler","unified-trade-in-cc-expander-controller").register("unified-trade-in-cc-card-controller",(b,a,d,f,n,h,y,p)=>{let g={};const t=new Set;let e={tradeInUX:{currentCXState:"",previousCXState:"",intentId:""},buyingOptionsContext:{selectedAapiBuyingOptionIndex:0,selectedModBuyingOptionIndex:0,isBuyingOptionTwisterPlusUnsupported:!1},ingressAsin:""};const q=(a,b="")=>({previousCXState:e.tradeInUX.currentCXState,currentCXState:a,
intentId:b}),u=(c)=>b.$(`#${c}${a.uiElements.DOM_RENDER_SUFFIX}`),C=(a,b)=>a.length===b.length&&a.every((a,c)=>a===b[c]),l=(a)=>{e=b.extend({},e,{buyingOptionsContext:b.extend({},e.buyingOptionsContext,a)})},c=(a,c=null)=>{c&&l(c);e=b.extend({},e,{tradeInUX:b.extend({},e.tradeInUX,q(a))})},D=()=>{var c=b.$(a.uiElements.selectors.cxStateInformation);if(!c.length)return a.ExtractionResult.STATELESS;g={};c=c.find(a.uiElements.selectors.tradeInOfferViewModelMatcher);return c.length&&c.toArray().every((c)=>
{{c=b.$(c);const z=parseInt(c.data(a.uiElements.selectors.dataAttributes.boKeyAttribute)),f=c.find(a.uiElements.selectors.longMessage);var e=c.find(a.uiElements.selectors.unifiedTradeInUXState).text().trim();const l=a.UnifiedTradeInUXState[e];e=f;var d=l;!isNaN(z)&&e.length&&d?c={boIndex:z,data:{longMessage:f,unifiedTradeInUXState:l,intentId:c.find(a.uiElements.selectors.intentId).text().trim()}}:(g={},v(a.UnifiedTradeInUXState.UNRECOVERABLE_ERROR),h.count("UnifiedTradeIn.Error.CardController.ExtractBuyingOptionData.InvalidBuyingOptionData"),
c=null)}if(!c)return!1;g[c.boIndex]=c.data;return!0})?a.ExtractionResult.EXTRACTION_SUCCEEDED:a.ExtractionResult.EXTRACTION_FAILED},E=()=>{Object.values(a.UnifiedTradeInUXState).forEach((c)=>{u(c).addClass(a.uiElements.styles.hiddenClass)})},m=()=>{var c=e.tradeInUX.previousCXState;c&&u(c).addClass(a.uiElements.styles.hiddenClass);a.DYNAMIC_MESSAGE_STATES.includes(e.tradeInUX.currentCXState)&&((c=g[e.buyingOptionsContext.selectedAapiBuyingOptionIndex])&&c.longMessage?(c=c.longMessage)?u(e.tradeInUX.currentCXState).find(a.uiElements.selectors.dynamicLongMessage).html(c.html()):
h.count("UnifiedTradeIn.Error.CardController.UpdateDynamicContent.NullLongMessage"):h.count(c?"UnifiedTradeIn.Error.CardController.RenderUxState.NullLongMessage":"UnifiedTradeIn.Error.CardController.RenderUxState.NullStateInformation"));(c=e.tradeInUX.currentCXState)?u(c).removeClass(a.uiElements.styles.hiddenClass):h.count("UnifiedTradeIn.Error.CardController.ShowUxState.NullUxState")},v=(a,b=null)=>{c(a,b);m()},r=()=>{e.tradeInUX.currentCXState===a.UnifiedTradeInUXState.INTENT_CREATED&&d.addAdditionalParamToATC(e.tradeInUX.intentId)},
F=(c)=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{b.trigger(a.events.actions.buyingOptionSwitched,c)})})},A=(c,d,f,u)=>{c={selectedModBuyingOptionIndex:c,selectedAapiBuyingOptionIndex:d,isBuyingOptionTwisterPlusUnsupported:f};d=g[d];if(f||!d||!d.unifiedTradeInUXState)return h.count("UnifiedTradeIn.Error.CardController.ValidateAndRender.InvalidBuyingOption"),v(a.UnifiedTradeInUXState.INVALID_BUYING_OPTION,c);if(!a.UX_ERROR_STATES.includes(d.unifiedTradeInUXState)&&u!==a.VALID_QUANTITY)return h.count("UnifiedTradeIn.Error.CardController.ValidateAndRender.InvalidQuantity"),
v(a.UnifiedTradeInUXState.INVALID_QUANTITY,c);l(c);(f=g[e.buyingOptionsContext.selectedAapiBuyingOptionIndex])&&f.unifiedTradeInUXState?e=b.extend({},e,{tradeInUX:b.extend({},e.tradeInUX,q(f.unifiedTradeInUXState,f.intentId||null))}):h.count(f?"UnifiedTradeIn.Error.CardController.SetTradeInUxStateFromContext.NullSelectedCxStateInformation":"UnifiedTradeIn.Error.CardController.SetTradeInUxStateFromContext.NullUnifiedTradeInUXState");m()},x=(c,b,e=!1)=>{if(g&&0<Object.keys(g).length){f.ccSelectionsClear(a.featureName);
var d=n.getSelectedQuantity(b);d=-1===d||"number"!==typeof d?a.VALID_QUANTITY:d;A(c,b,e,d);r();F(b)}};b.on(a.events.atc.postAtcBottomSheetId,()=>{const c=g[e.buyingOptionsContext.selectedAapiBuyingOptionIndex];c&&c.unifiedTradeInUXState===a.UnifiedTradeInUXState.INTENT_CREATED&&(B(),b.delay(()=>{y.refresh(e.buyingOptionsContext.selectedAapiBuyingOptionIndex,e.ingressAsin,{onStart:()=>{},onSuccess:()=>{w()},onFailure:()=>{h.count("UnifiedTradeIn.Error.CardController.Initialize.AtcExecutedStateRefreshFailed");
w()}})},a.twisterRefresh.refreshDelayAfterAtcMs))});b.on(a.events.quantity.quantityUpdatedEvent,function(c){g&&0<Object.keys(g).length&&(f.ccSelectionsClear(a.featureName),A(e.buyingOptionsContext.selectedModBuyingOptionIndex,e.buyingOptionsContext.selectedAapiBuyingOptionIndex,e.buyingOptionsContext.isBuyingOptionTwisterPlusUnsupported,c),r())});const B=()=>{b.capabilities.mobile?b.$(a.uiElements.selectors.expanderSectionClass).addClass(a.uiElements.styles.refreshOverlayClassMobile):b.$(a.uiElements.selectors.expanderSectionClass).addClass(a.uiElements.styles.refreshOverlayClassDesktop)},
w=()=>{b.capabilities.mobile?b.$(a.uiElements.selectors.expanderSectionClass).removeClass(a.uiElements.styles.refreshOverlayClassMobile):b.$(a.uiElements.selectors.expanderSectionClass).removeClass(a.uiElements.styles.refreshOverlayClassDesktop)};return{initialize:()=>{k.when(a.events.actions.atfRendered).execute(()=>{b.trigger(a.events.actions.cardControllerInitializeCalled);const c=D();if(c!==a.ExtractionResult.STATELESS){var d=parseInt(b.$(a.uiElements.selectors.selectedBuyingOptionIndex).text().trim()),
f=b.$(a.twisterRefresh.payloadElementSelector).data(a.twisterRefresh.asinDataAttribute)||null;c===a.ExtractionResult.EXTRACTION_FAILED||isNaN(d)||!f?(h.count("UnifiedTradeIn.Error.CardController.Initialize.ExtractBuyingOptionFailed"),E(),g={},v(a.UnifiedTradeInUXState.UNRECOVERABLE_ERROR)):(e=b.extend({},e,{ingressAsin:f}),x(d,d,!1),t.has(e.ingressAsin)?y.refresh(e.buyingOptionsContext.selectedAapiBuyingOptionIndex,e.ingressAsin,{onStart:()=>{B();p.collapse()},onSuccess:()=>{w();p.expand()},onFailure:()=>
{h.count("UnifiedTradeIn.Error.CardController.Initialize.AtfRenderedStateRefreshFailed");w();p.expand()}}):t.add(e.ingressAsin))}});k.when(a.events.actions.dpLatencyMarker).execute(()=>{p.expand()})},switchBuyingOption:x,updateBuyingOptionsState:(c)=>{if(g&&0<Object.keys(g).length){var b=Object.keys(g).sort(),d=Object.keys(c).sort();C(b,d)?(g=c,x(e.buyingOptionsContext.selectedModBuyingOptionIndex,e.buyingOptionsContext.selectedAapiBuyingOptionIndex,e.buyingOptionsContext.isBuyingOptionTwisterPlusUnsupported)):
(g={},v(a.UnifiedTradeInUXState.UNRECOVERABLE_ERROR),h.count("UnifiedTradeIn.Error.CardController.UpdateBuyingOptionsState.KeysMismatch"))}},showRemoteErrorState:()=>{g&&0<Object.keys(g).length&&v(a.UnifiedTradeInUXState.REMOTE_OPERATION_FAILED)},getSelectedAapiBuyingOptionIndex:()=>e.buyingOptionsContext.selectedAapiBuyingOptionIndex,getBuyingOptionIntentMap:()=>{const c={};Object.keys(g).forEach((a)=>{c[a]=g[a].intentId||""});return c},getIngressAsin:()=>e.ingressAsin}});"use strict";k.when("A",
"cc-manager","unified-trade-in-cc-constants","unified-trade-in-cc-expander-controller","unified-trade-in-cc-card-controller").register("unified-trade-in-cc-registration",(b,a,d,f,k)=>{const {featureName:h,featureAttribution:n}=d;a.registerFeature({featureName:h,featureAttribution:n,isMultiSelection:1},{init:function(a){k.initialize()},validateInputParams:function(a){return!0},cardExpand:f.expand,cardCollapse:f.collapse,switchBuyingOption:function(a,b,d,e,f,h,n){k.switchBuyingOption(a,h,n)}})});"use strict";
k.when("A").register("unified-trade-in-cc-constants",()=>({featureName:"unifiedTradeInIngress",featureAttribution:"Website/CETech/UnifiedTradeIn",UnifiedTradeInUXState:Object.freeze({NO_INTENT:"NO_INTENT",INTENT_CREATED:"INTENT_CREATED",INTENT_BO_INVALID:"INTENT_BO_INVALID",REMOTE_OPERATION_FAILED:"REMOTE_OPERATION_FAILED",UNRECOVERABLE_ERROR:"UNRECOVERABLE_ERROR",INVALID_BUYING_OPTION:"INVALID_BUYING_OPTION",INVALID_QUANTITY:"INVALID_QUANTITY"}),UX_ERROR_STATES:["INTENT_BO_INVALID","REMOTE_OPERATION_FAILED",
"UNRECOVERABLE_ERROR","INVALID_BUYING_OPTION","INVALID_QUANTITY"],DYNAMIC_MESSAGE_STATES:["NO_INTENT","INTENT_CREATED","INTENT_BO_INVALID"],VALID_QUANTITY:1,ExtractionResult:Object.freeze({STATELESS:"STATELESS",EXTRACTION_SUCCEEDED:"EXTRACTION_SUCCEEDED",EXTRACTION_FAILED:"EXTRACTION_FAILED"}),remoteOperations:{lifecycle:Object.freeze({NOT_STARTED:"NOT_STARTED",IN_PROGRESS:"IN_PROGRESS",ERROR:"ERROR"}),responseCodes:Object.freeze({SUCCESS:"SUCCESS",SUCCESS_STATE_UPDATED:"SUCCESS_STATE_UPDATED"}),
timeoutMs:2500,responseSuffix:":response"},twisterRefresh:{eventName:"a:tradeIn:tanooki:v3:fetchIngressMessaging",payloadElementSelector:"#utxTwisterRefreshPayload",asinDataAttribute:"asin",refreshDelayAfterAtcMs:500},uiElements:{DOM_RENDER_SUFFIX:"_DOM_RENDER",popoverIds:{utxPopoverContent:"utx_popover_content"},styles:{hiddenClass:"aok-hidden",invisibleClass:"utx-invisible",refreshOverlayClassDesktop:"js-feature-refresh-overlay",refreshOverlayClassMobile:"tp-js-feature-refresh-overlay"},buttonFactory:{classPrefix:"unified-tradein-btn-",
actionButtonClass:"utx-action-button",actionButtonSelector:".utx-action-button",displayTextSelector:".utx-display-text",loadingSpinnerSelector:".utx-loading-spinner",spinnerDelayMs:1E3,uniqueIds:{spawnGrading:"spawn-grading",removeConfirmation:"remove-confirmation",retry:"retry"}},selectors:{expanderContent:".unifiedTradeInIngressExpanderContent",expanderContentExpand:"unifiedTradeInIngressExpanderContent-expand",expanderIconDesktop:".unifiedTradeInIngressExpanderIconDesktop",expanderIconMobile:".unifiedTradeInIngressExpanderIconMobile",
expanderSectionClass:".unifiedTradeInIngressExpanderSection",selectedBuyingOptionIndex:"#utxSelectedBuyingOptionIndex",dynamicLongMessage:".utxDynamicLongMessage",cxStateInformation:"#cxStateInformation",unifiedTradeInUXState:".unifiedTradeInUXState",tradeInOfferViewModelMatcher:'[id^\x3d"tradeInOfferViewModel_"]',longMessage:".utxLongMessage",intentId:".intentId",payload:".payload",visibleFilter:":visible",dataAttributes:{tradeInIntentId:"tradeInIntentId",boKeyAttribute:"bo-key"},quantity:{selectByName:'select[name\x3d"quantity"]'},
buyBoxAccordion:"#buyBoxAccordion"}},events:{actions:{toggleExpander:"toggleUnifiedTradeInIngressExpander",tradeInSubmitted:"a:tradeIn:tanooki:v3:intentAction:create:response",atfRendered:"atf",buyingOptionSwitched:"unifiedTradeIn:buyingOption:switched",closeSideSheet:"a:tradeIn:tanooki:v3:closeSidesheet",cardControllerInitializeCalled:"unifiedTradeIn:cardController:initializeCalled",dpLatencyMarker:"dp-latency-marker"},declarativeActions:{removeButton:"unifiedtradeiningress_remove_button",spawnGradingQuestionnaire:"unifiedtradeiningress_spawnselfgradingquestionaire_button",
retryButton:"unifiedtradeiningress_retry_button"},domEvents:{click:"click"},quantity:{dropdownSelectedEvent:"a:dropdown:selected:quantity",quantityUpdatedEvent:"unifiedTradeIn:quantity:updated"},atc:{postAtcBottomSheetId:"a:sheet:beforeShow:attach_accessory_sheet"}},actions:{toggleExpander:"toggleUnifiedTradeInIngressExpander",tradeInSubmitted:"unifiedTradeIn:detailPage:tradeInSubmitted",atfRendered:"atf"},selectors:{expanderContent:".unifiedTradeInIngressExpanderContent",expanderContentExpand:"unifiedTradeInIngressExpanderContent-expand",
expanderIconDesktop:".unifiedTradeInIngressExpanderIconDesktop",expanderIconMobile:".unifiedTradeInIngressExpanderIconMobile",dataAttributes:{tradeInIntentId:"tradeInIntentId"}}}));"use strict";k.when("A","unified-trade-in-cc-constants","unified-trade-in-remote-operations-tanookiv3-bridge","unified-trade-in-popover-controller","unified-trade-in-cc-card-controller","unified-trade-in-button-factory","unified-trade-in-scroll-controller","unified-trade-in-metric-emitter").register("unified-trade-in-action-listeners",
(b,a,d,f,k,h,m,p)=>{function g(b,e){const f=b.data&&b.data.auiEventName;if(f){var c=JSON.parse(b.$currentTarget.find(a.uiElements.selectors.payload).text().trim()||"{}"),g=k.getBuyingOptionIntentMap();Object.keys(c).length===Object.keys(g).length?Object.keys(c).forEach((a)=>{c[a].intentId=g[a]}):p.count("UnifiedTradeIn.Error.DeclarativeActionHandler.PublishEventWithPayload.KeysLengthMismatch");b={eventName:f,payload:{buyingOptionIndex:String(k.getSelectedAapiBuyingOptionIndex()),buyingOptionContextMap:c,
ingressAsin:k.getIngressAsin()}};d.publishWithLifeCycle(b,e)}else p.count("UnifiedTradeIn.Error.DeclarativeActionHandler.PublishEventWithPayload.NullEventToFire")}let n,e,q;b.declarative(a.events.declarativeActions.spawnGradingQuestionnaire,a.events.domEvents.click,function(b){if(!e){const d=b.$currentTarget.find(a.uiElements.buttonFactory.actionButtonSelector).first();e=h.getInstance(d,a.uiElements.buttonFactory.uniqueIds.spawnGrading)}e&&!e.isBlocked()&&g(b,{onStart:()=>e.block(),onSuccess:()=>
{e.reset();m.blockScrolling()},onFailure:()=>e.reset()})});b.declarative(a.events.declarativeActions.removeButton,a.events.domEvents.click,function(b){const e=b.$currentTarget.find(a.uiElements.buttonFactory.actionButtonSelector).first();(n=h.getInstance(e,a.uiElements.buttonFactory.uniqueIds.removeConfirmation))&&!n.isBlocked()&&g(b,{onStart:()=>n.block(),onSuccess:()=>{n.destroy();f.hidePopover(a.uiElements.popoverIds.utxPopoverContent)},onFailure:()=>{n.destroy();f.hidePopover(a.uiElements.popoverIds.utxPopoverContent)}})});
b.declarative(a.events.declarativeActions.retryButton,a.events.domEvents.click,function(b){q||(b=b.$currentTarget.find(a.uiElements.buttonFactory.actionButtonSelector).first(),q=h.getInstance(b,a.uiElements.buttonFactory.uniqueIds.retry));q&&!q.isBlocked()&&d.retryLastFailedOperation({onStart:()=>q.block(),onSuccess:()=>q.reset(),onFailure:()=>q.reset()})})});"use strict";k.when("A","cc-manager","unified-trade-in-cc-constants","unified-trade-in-metric-emitter").register("unified-trade-in-cc-expander-controller",
(b,a,d,f)=>{function k(b){const e=h(g.expanderContent).hasClass(g.expanderContentExpand);b=b!==r?b:!e;h(t?g.expanderIconMobile:g.expanderIconDesktop).toggleClass("rotate",b);b&&0<h(g.expanderContent).length?(h(g.expanderContent).addClass(g.expanderContentExpand),a.cardExpanded(m),f.count("UnifiedTradeIn.ExpanderController.CardExpanded")):(h(g.expanderContent).removeClass(g.expanderContentExpand),f.count("UnifiedTradeIn.ExpanderController.CardCollapsed"))}const h=b.$,{featureName:m,actions:p,selectors:g}=
d,t=b.capabilities&&b.capabilities.mobile;b.declarative(p.toggleExpander,["click","keydown"],function(a){"keydown"===a.type&&13!==a.$event.keyCode&&32!==a.$event.keyCode||k()});return{toggleTradeInIngressCard:k,expand:()=>k(!0),collapse:()=>k(!1)}});k.register("unified-trade-in-metric-emitter",()=>({count:function(b){m.ue&&m.ue.count&&m.ue.count(b,(m.ue.count(b)||0)+1)}}));"use strict";k.when("A","a-modal","unified-trade-in-metric-emitter").register("unified-trade-in-popover-controller",(b,a,d)=>
({hidePopover:function(b){b?(b=a.get(b))?(b.hide(),b.isActive()&&(d.count("UnifiedTradeIn.Error.PopOverController.HidePopover.HidePopoverFailed"),b.hide())):d.count("UnifiedTradeIn.Error.PopOverController.HidePopover.NullPopoverInstance"):d.count("UnifiedTradeIn.Error.PopOverController.HidePopover.NullPopoverName")}}));"use strict";k.when("A","unified-trade-in-cc-constants","a-dropdown").register("unified-trade-in-quantity-handler",(b,a,d)=>{b.on(a.events.quantity.dropdownSelectedEvent,function(d){b.trigger(a.events.quantity.quantityUpdatedEvent,
Number(d.value))});return{getSelectedQuantity:function(f){f=b.$(a.uiElements.selectors.buyBoxAccordion).children().eq(f).find(a.uiElements.selectors.quantity.selectByName);return(f=f.length&&d.getSelect(f))?Number(f.val()):-1}}});"use strict";k.when("A","unified-trade-in-cc-constants","unified-trade-in-cc-card-controller","unified-trade-in-metric-emitter").register("unified-trade-in-remote-operations-tanookiv3-bridge",(b,a,d,f)=>{function k(){if(crypto&&crypto.randomUUID)return crypto.randomUUID();
if(crypto&&crypto.getRandomValues){const a=new Uint8Array(16);crypto.getRandomValues(a);return Array.from(a,(a)=>a.toString(16).padStart(2,"0")).join("")}return Date.now().toString(36)+Math.random().toString(36).substring(2)}function h(c,d={}){if(!c||!c.eventName)return{};const e=k();return{requestId:e,triggerEventName:c.eventName,eventPayload:b.extend({},c.payload||{},{requestId:e}),responseEventName:c.eventName+a.remoteOperations.responseSuffix,timeoutId:null,callbacks:d}}function m(){const c=l.current;
b.on(c.responseEventName,q);b.trigger(c.triggerEventName,c.eventPayload);c.timeoutId=b.delay(()=>{l.current===c&&(f.count("UnifiedTradeIn.Error.RemoteOperationsBridge.HandleTimeout"),p())},a.remoteOperations.timeoutMs)}function p(){const a=l.current&&l.current.callbacks;if(a&&a.onFailure)a.onFailure();u();l.lastFailed=l.current;l.current=null;d.showRemoteErrorState()}function g(c){for(const b of Object.keys(c)){const d=c[b],e=a.UnifiedTradeInUXState[d.uxState];if(!e)return!1;if(a.DYNAMIC_MESSAGE_STATES.includes(e)&&
!d.longMessage)return f.count("UnifiedTradeIn.Error.RemoteOperationsBridge.ValidateUxStates.NullLongMessage"),!1}return!0}function t(c){const d={},e=c.tradeInIngressMessaging;if(!e)return d;if(!g(e))return{};Object.keys(e).forEach((c)=>{const f=e[c],g=a.UnifiedTradeInUXState[f.uxState];d[c]={longMessage:b.$("\x3cdiv\x3e").text(f.longMessage||""),unifiedTradeInUXState:g,intentId:f.intentId||""}});return d}function e(){const a=l.current&&l.current.callbacks;if(a&&a.onSuccess)a.onSuccess();r()}function q(c){l.current&&
l.current.requestId===c.requestId&&(c.status===a.remoteOperations.responseCodes.SUCCESS?e():c.status===a.remoteOperations.responseCodes.SUCCESS_STATE_UPDATED?(c=t(c),d.updateBuyingOptionsState(c),e()):(f.count("UnifiedTradeIn.Error.RemoteOperationsBridge.HandleErrorResponse"),p()))}function u(){const a=l.current;a&&(a.responseEventName&&b.off(a.responseEventName),a.timeoutId&&clearTimeout(a.timeoutId))}function r(){u();l.current=null;l.lastFailed=null}const l={current:null,lastFailed:null};b.on(a.events.actions.tradeInSubmitted,
function(b){b.status===a.remoteOperations.responseCodes.SUCCESS_STATE_UPDATED?(b=t(b),d.updateBuyingOptionsState(b)):f.count(b.status?"UnifiedTradeIn.Error.RemoteOperationsBridge.TradeInSubmittedHandler.UnhandledStatusCode."+b.status:"UnifiedTradeIn.Error.RemoteOperationsBridge.TradeInSubmittedHandler.NullStatusCode")});b.on(a.events.actions.buyingOptionSwitched,function(){l.lastFailed=null});b.on(a.events.actions.cardControllerInitializeCalled,function(){r()});return{publishWithLifeCycle:function(a,
b={}){b=b||{};a=h(a,b);if(0===Object.keys(a).length)return!1;if(l.current){const a=l.current.callbacks;if(a&&a.onFailure)a.onFailure();r()}if(b.onStart)b.onStart();l.lastFailed=null;l.current=a;m();return!0},retryLastFailedOperation:function(a){if(!l.lastFailed||l.current){if(a&&a.onBlocked)a.onBlocked();return!1}if((a=a||l.lastFailed.callbacks)&&a.onStart)a.onStart();l.current=b.extend({},l.lastFailed);l.current.callbacks=a;l.lastFailed=null;m();return!0}}});"use strict";k.when("A","unified-trade-in-cc-constants").register("unified-trade-in-scroll-controller",
(b,a)=>{b.on(a.events.actions.closeSideSheet,function(){b.$("body").css("overflow","auto")});return{blockScrolling:function(){b.$("body").css("overflow","hidden")}}});"use strict";k.when("A","unified-trade-in-cc-constants").register("unified-trade-in-state-freshness-handler",(b,a)=>({refresh:(d,f,m)=>{const h=b.$(a.twisterRefresh.payloadElementSelector),n={buyingOptionContextMap:JSON.parse(h.text().trim()||"{}"),ingressAsin:f,buyingOptionIndex:d};k.when("unified-trade-in-remote-operations-tanookiv3-bridge").execute(function(b){b.publishWithLifeCycle({eventName:a.twisterRefresh.eventName,
payload:n},m)})}}))});